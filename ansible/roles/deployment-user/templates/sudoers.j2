# Sudoers configuration for {{ deployment_user }}
# This file grants specific passwordless sudo permissions for homelab deployment
# Generated by Ansible - DO NOT EDIT MANUALLY

# User specification for {{ deployment_user }}
# Allow passwordless sudo only for specific required commands

{% for command in deployment_sudo_commands %}
{{ deployment_user }} ALL=(ALL) NOPASSWD: {{ command }}
{% endfor %}

# Additional rules for environment preservation
Defaults:{{ deployment_user }} env_keep += "PATH HOME KUBECONFIG"
Defaults:{{ deployment_user }} !requiretty

# Log all commands for audit purposes
Defaults:{{ deployment_user }} log_input, log_output
Defaults:{{ deployment_user }} iolog_dir=/var/log/sudo-io/{{ deployment_user }}

# Security settings
Defaults:{{ deployment_user }} timestamp_timeout=5
Defaults:{{ deployment_user }} passwd_tries=3
