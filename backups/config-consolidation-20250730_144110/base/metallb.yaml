# MetalLB Configuration
# Load balancer configuration for bare metal Kubernetes

metallb:
  # Enable MetalLB
  enabled: true

  # Controller configuration
  controller:
    image:
      repository: quay.io/metallb/controller
      tag: v0.13.12
    resources:
      limits:
        cpu: 100m
        memory: 100Mi
      requests:
        cpu: 50m
        memory: 50Mi

  # Speaker configuration
  speaker:
    image:
      repository: quay.io/metallb/speaker
      tag: v0.13.12
    resources:
      limits:
        cpu: 100m
        memory: 100Mi
      requests:
        cpu: 50m
        memory: 50Mi
    tolerateMaster: true

  # IP Address Pools
  ip_pools:
    default:
      name: "default-pool"
      protocol: "layer2"
      addresses: "192.168.1.240-192.168.1.250"
      auto_assign: true
      avoid_buggy_ips: true

    development:
      name: "dev-pool"
      protocol: "layer2"
      addresses: "192.168.25.200-192.168.25.210"
      auto_assign: true
      avoid_buggy_ips: true

    staging:
      name: "staging-pool"
      protocol: "layer2"
      addresses: "192.168.26.200-192.168.26.210"
      auto_assign: true
      avoid_buggy_ips: true

    production:
      name: "prod-pool"
      protocol: "layer2"
      addresses: "192.168.16.200-192.168.16.210"
      auto_assign: true
      avoid_buggy_ips: true

  # L2 Advertisement configuration
  l2:
    enabled: true
    interfaces:
      - eth0

  # BGP configuration (disabled by default)
  bgp:
    enabled: false
    my_asn: 64500
    peer_asn: 64501
    peer_address: "192.168.1.1"

  # Service annotations for MetalLB
  service_annotations:
    # Load balancer class
    metallb.universe.tf/loadBalancerIPs: "auto"

    # Address pool selection
    metallb.universe.tf/address-pool: "{{ .Values.metallb.ip_pools.default.name }}"

    # Allow shared IP
    metallb.universe.tf/allow-shared-ip: "true"
